{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/dedylu/perfect-job/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/dedylu/perfect-job/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/dedylu/perfect-job/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useReducer}from\"react\";import Footer from\"../Component/Footer\";import Nav from\"../Component/Nav\";import Sidebar from\"../Component/Sidebar\";import{ToastContainer,toast}from\"react-toastify\";import{CategoryReducer}from\"../../CategoryReducer\";import{Link,useNavigate}from\"react-router-dom\";import{Store}from\"../../Store\";import Spiner from\"../../components/Spiner\";import axios from\"../../axios\";import{Helmet}from\"react-helmet-async\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var CatPage=function CatPage(){var navigate=useNavigate();var _useContext=useContext(Store),state=_useContext.state;var user=state.user;var _useReducer=useReducer(CategoryReducer,{loading:true,error:\"\"}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,error=_useReducer2$.error,category=_useReducer2$.category,loadingDelete=_useReducer2$.loadingDelete,successDelete=_useReducer2$.successDelete,dispatch=_useReducer2[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch({type:\"FETCH_REQUEST\"});_context.next=4;return axios.get(\"/category/categories\");case 4:_yield$axios$get=_context.sent;data=_yield$axios$get.data;dispatch({type:\"FETCH_SUCCESS\",payload:data});_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);dispatch({type:\"FETCH_FAIL\",payload:_context.t0});case 12:case\"end\":return _context.stop();}},_callee,null,[[0,9]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();if(successDelete){dispatch({type:\"DELETE_RESET\"});}else{fetchData();}},[user,successDelete]);var deleteHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(cat){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!window.confirm(\"Are you sure to delete?\")){_context2.next=13;break;}_context2.prev=1;dispatch({type:\"DELETE_REQUEST\"});_context2.next=5;return axios.delete(\"/category/cat/\".concat(cat._id),{headers:{authorization:\"Bearer \".concat(user.token)}});case 5:toast.success(\"Category deleted successfully\");dispatch({type:\"DELETE_SUCCESS\"});_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);toast.success('Fail to delete');dispatch({type:\"DELETE_FAIL\"});case 13:case\"end\":return _context2.stop();}},_callee2,null,[[1,9]]);}));return function deleteHandler(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:\"Categories\"})}),/*#__PURE__*/_jsx(Nav,{}),/*#__PURE__*/_jsx(Sidebar,{}),/*#__PURE__*/_jsxs(\"main\",{id:\"main\",className:\"main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"pagetitle\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"TheEmployer\"}),/*#__PURE__*/_jsx(\"nav\",{children:/*#__PURE__*/_jsxs(\"ol\",{className:\"breadcrumb\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumb-item\",children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumb-item active\",children:\"Dashboard\"})]})})]}),/*#__PURE__*/_jsx(\"section\",{className:\"section dashboard\",children:loading?/*#__PURE__*/_jsx(Spiner,{}):error?toast.success(error):/*#__PURE__*/_jsxs(_Fragment,{children:[user&&user.isAdmin===true?/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(Link,{to:\"/adminnewcat\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",children:\"Add New\"})})}):\"\",/*#__PURE__*/_jsx(\"div\",{className:\"data-table\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"NAME\"}),/*#__PURE__*/_jsx(\"th\",{children:\"ACTIONS\"}),/*#__PURE__*/_jsx(\"th\",{children:\"ACTIONS\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:category.map(function(cat){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"No.c\"}),/*#__PURE__*/_jsx(\"td\",{children:cat.name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",\"data-toggle\":\"modal\",\"data-target\":\"#exampleModal\",className:\"btn btn-secondary\",disabled:user.isAdmin===false,onClick:function onClick(){return navigate(\"/editcat/\".concat(cat.name,\"/\").concat(cat._id));},children:\"Edit\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",variant:\"danger\",className:\"btn btn-danger\",disabled:user.isAdmin===false,onClick:function onClick(){return deleteHandler(cat);},children:\"Delete\"})})]},cat._id);})})]})})]})})]}),/*#__PURE__*/_jsx(Footer,{})]});};","map":{"version":3,"names":["React","useContext","useEffect","useReducer","Footer","Nav","Sidebar","ToastContainer","toast","CategoryReducer","Link","useNavigate","Store","Spiner","axios","Helmet","CatPage","navigate","state","user","loading","error","category","loadingDelete","successDelete","dispatch","fetchData","type","get","data","payload","deleteHandler","cat","window","confirm","delete","_id","headers","authorization","token","success","isAdmin","map","name"],"sources":["C:/Users/dedylu/perfect-job/client/src/AdminDashboard/adminpages/CatPage.js"],"sourcesContent":["import React, { useContext, useEffect, useReducer } from \"react\";\r\nimport Footer from \"../Component/Footer\";\r\nimport Nav from \"../Component/Nav\";\r\nimport Sidebar from \"../Component/Sidebar\";\r\nimport { ToastContainer, toast } from \"react-toastify\";\r\nimport { CategoryReducer } from \"../../CategoryReducer\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { Store } from \"../../Store\";\r\nimport Spiner from \"../../components/Spiner\";\r\nimport axios from \"../../axios\";\r\nimport { Helmet } from \"react-helmet-async\";\r\nexport const CatPage = () => {\r\n  const navigate = useNavigate();\r\n  const { state } = useContext(Store);\r\n  const { user } = state;\r\n  const [{ loading, error, category, loadingDelete, successDelete }, dispatch] =\r\n    useReducer(CategoryReducer, {\r\n      loading: true,\r\n      error: \"\",\r\n    });\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        dispatch({ type: \"FETCH_REQUEST\" });\r\n        const { data } = await axios.get(`/category/categories`);\r\n        dispatch({ type: \"FETCH_SUCCESS\", payload: data });\r\n      } catch (err) {\r\n        dispatch({\r\n          type: \"FETCH_FAIL\",\r\n          payload: err,\r\n        });\r\n      }\r\n    };\r\n    if (successDelete) {\r\n      dispatch({ type: \"DELETE_RESET\" });\r\n    } else {\r\n      fetchData();\r\n    }\r\n  }, [user, successDelete]);\r\n   const deleteHandler = async (cat) => {\r\n     if (window.confirm(\"Are you sure to delete?\")) {\r\n       try {\r\n         dispatch({ type: \"DELETE_REQUEST\" });\r\n         await axios.delete(`/category/cat/${cat._id}`, {\r\n           headers: { authorization: `Bearer ${user.token}` },\r\n         });\r\n         toast.success(\"Category deleted successfully\");\r\n         dispatch({ type: \"DELETE_SUCCESS\" });\r\n       } catch (error) {\r\n         toast.success('Fail to delete');\r\n         dispatch({\r\n           type: \"DELETE_FAIL\",\r\n         });\r\n       }\r\n     }\r\n   };\r\n  return (\r\n    <div>\r\n      <ToastContainer />\r\n      <Helmet>\r\n        <title>Categories</title>\r\n      </Helmet>\r\n      <Nav />\r\n      <Sidebar />\r\n      <main id=\"main\" className=\"main\">\r\n        <div className=\"pagetitle\">\r\n          <h1>TheEmployer</h1>\r\n          <nav>\r\n            <ol className=\"breadcrumb\">\r\n              <li className=\"breadcrumb-item\">\r\n                <a href=\"/\">Home</a>\r\n              </li>\r\n              <li className=\"breadcrumb-item active\">Dashboard</li>\r\n            </ol>\r\n          </nav>\r\n        </div>\r\n\r\n        <section className=\"section dashboard\">\r\n          {loading ? (\r\n            <Spiner />\r\n          ) : error ? (\r\n            toast.success(error)\r\n          ) : (\r\n            <>\r\n              {user && user.isAdmin === true ? (\r\n                <div className=\"container\">\r\n                  <Link to=\"/adminnewcat\">\r\n                    <button className=\"btn btn-primary\">Add New</button>\r\n                  </Link>\r\n                </div>\r\n              ) : (\r\n                \"\"\r\n              )}\r\n\r\n              <div className=\"data-table\">\r\n                <table className=\"table\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th>ID</th>\r\n                      <th>NAME</th>\r\n                      <th>ACTIONS</th>\r\n                      <th>ACTIONS</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {category.map((cat) => (\r\n                      <tr key={cat._id}>\r\n                        <td>No.c</td>\r\n                        <td>{cat.name}</td>\r\n                        <td>\r\n                          <button\r\n                            type=\"button\"\r\n                            data-toggle=\"modal\"\r\n                            data-target=\"#exampleModal\"\r\n                            className=\"btn btn-secondary\"\r\n                            disabled={user.isAdmin === false}\r\n                            onClick={() => navigate(`/editcat/${cat.name}/${cat._id}`)}\r\n                          >\r\n                            Edit\r\n                          </button>\r\n                        </td>\r\n                        <td>\r\n                          <button\r\n                            type=\"button\"\r\n                            variant=\"danger\"\r\n                            className=\"btn btn-danger\"\r\n                            disabled={user.isAdmin === false}\r\n                            onClick={() => deleteHandler(cat)}\r\n                          >\r\n                            Delete\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </>\r\n          )}\r\n        </section>\r\n      </main>\r\n\r\n      <Footer />\r\n    </div>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}